{
  "meta": {
    "buildId": "build-1768866721349",
    "repoOwner": "AnouarY02",
    "repoName": "ai-app-saas",
    "branch": "build-1768866721349",
    "appName": "TaskMaster Pro",
    "baseBranch": "main"
  },
  "functionalitySpec": {
    "stack": {
      "framework": "Next.js 14 App Router",
      "language": "TypeScript",
      "styling": [
        "Tailwind CSS",
        "shadcn/ui"
      ],
      "api": [
        "Next.js Route Handlers (app/api)"
      ],
      "stateManagement": "React Context + useReducer",
      "dataLayer": "In-memory store (singleton per entity)"
    },
    "tenancy": {
      "strategy": "team-based",
      "isolationLevel": "team"
    },
    "roles": [
      {
        "name": "admin",
        "permissions": [
          "manage_team",
          "manage_projects",
          "manage_users",
          "view_analytics",
          "manage_tasks",
          "manage_boards"
        ]
      },
      {
        "name": "member",
        "permissions": [
          "view_projects",
          "manage_tasks",
          "view_analytics",
          "comment_tasks"
        ]
      }
    ],
    "entities": [
      {
        "name": "User",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique user identifier"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Full name"
          },
          {
            "name": "email",
            "type": "string",
            "required": true,
            "description": "Email address"
          },
          {
            "name": "avatarUrl",
            "type": "string",
            "required": false,
            "description": "Profile picture URL"
          },
          {
            "name": "role",
            "type": "string",
            "required": true,
            "description": "Role in the team (admin, member)"
          }
        ],
        "relations": [
          {
            "type": "belongsToMany",
            "entity": "Team",
            "through": "members"
          },
          {
            "type": "hasMany",
            "entity": "Task",
            "foreignKey": "assigneeId"
          },
          {
            "type": "hasMany",
            "entity": "Comment",
            "foreignKey": "authorId"
          },
          {
            "type": "hasMany",
            "entity": "Notification",
            "foreignKey": "userId"
          }
        ]
      },
      {
        "name": "Team",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique team identifier"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Team name"
          },
          {
            "name": "members",
            "type": "User[]",
            "required": true,
            "description": "List of team members"
          }
        ],
        "relations": [
          {
            "type": "hasMany",
            "entity": "User",
            "foreignKey": "teamId"
          },
          {
            "type": "hasMany",
            "entity": "Project",
            "foreignKey": "teamId"
          },
          {
            "type": "hasMany",
            "entity": "Metric",
            "foreignKey": "teamId"
          }
        ]
      },
      {
        "name": "Project",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique project identifier"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Project name"
          },
          {
            "name": "description",
            "type": "string",
            "required": false,
            "description": "Project description"
          },
          {
            "name": "teamId",
            "type": "string",
            "required": true,
            "description": "Owning team"
          },
          {
            "name": "createdAt",
            "type": "Date",
            "required": true,
            "description": "Creation timestamp"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "Team",
            "foreignKey": "teamId"
          },
          {
            "type": "hasMany",
            "entity": "Board",
            "foreignKey": "projectId"
          }
        ]
      },
      {
        "name": "Board",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique board identifier"
          },
          {
            "name": "projectId",
            "type": "string",
            "required": true,
            "description": "Associated project"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Board name"
          },
          {
            "name": "columns",
            "type": "Column[]",
            "required": true,
            "description": "Columns in the board"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "Project",
            "foreignKey": "projectId"
          },
          {
            "type": "hasMany",
            "entity": "Column",
            "foreignKey": "boardId"
          }
        ]
      },
      {
        "name": "Column",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique column identifier"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Column name"
          },
          {
            "name": "taskIds",
            "type": "string[]",
            "required": true,
            "description": "Ordered list of task IDs"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "Board",
            "foreignKey": "boardId"
          },
          {
            "type": "hasMany",
            "entity": "Task",
            "through": "taskIds"
          }
        ]
      },
      {
        "name": "Task",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique task identifier"
          },
          {
            "name": "title",
            "type": "string",
            "required": true,
            "description": "Task title"
          },
          {
            "name": "description",
            "type": "string",
            "required": false,
            "description": "Task details"
          },
          {
            "name": "assigneeId",
            "type": "string",
            "required": false,
            "description": "Assigned user"
          },
          {
            "name": "status",
            "type": "string",
            "required": true,
            "description": "Task status (todo, in-progress, done)"
          },
          {
            "name": "dueDate",
            "type": "Date",
            "required": false,
            "description": "Due date"
          },
          {
            "name": "createdAt",
            "type": "Date",
            "required": true,
            "description": "Creation timestamp"
          },
          {
            "name": "comments",
            "type": "Comment[]",
            "required": false,
            "description": "Task comments"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "User",
            "foreignKey": "assigneeId"
          },
          {
            "type": "hasMany",
            "entity": "Comment",
            "foreignKey": "taskId"
          }
        ]
      },
      {
        "name": "Comment",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique comment identifier"
          },
          {
            "name": "taskId",
            "type": "string",
            "required": true,
            "description": "Associated task"
          },
          {
            "name": "authorId",
            "type": "string",
            "required": true,
            "description": "Comment author"
          },
          {
            "name": "content",
            "type": "string",
            "required": true,
            "description": "Comment text"
          },
          {
            "name": "createdAt",
            "type": "Date",
            "required": true,
            "description": "Creation timestamp"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "Task",
            "foreignKey": "taskId"
          },
          {
            "type": "belongsTo",
            "entity": "User",
            "foreignKey": "authorId"
          }
        ]
      },
      {
        "name": "Notification",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique notification identifier"
          },
          {
            "name": "userId",
            "type": "string",
            "required": true,
            "description": "Recipient user"
          },
          {
            "name": "type",
            "type": "string",
            "required": true,
            "description": "Notification type (task-assigned, comment, etc.)"
          },
          {
            "name": "message",
            "type": "string",
            "required": true,
            "description": "Notification message"
          },
          {
            "name": "read",
            "type": "boolean",
            "required": true,
            "description": "Read status"
          },
          {
            "name": "createdAt",
            "type": "Date",
            "required": true,
            "description": "Creation timestamp"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "User",
            "foreignKey": "userId"
          }
        ]
      },
      {
        "name": "Metric",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique metric identifier"
          },
          {
            "name": "teamId",
            "type": "string",
            "required": true,
            "description": "Associated team"
          },
          {
            "name": "type",
            "type": "string",
            "required": true,
            "description": "Metric type (tasks-completed, avg-completion-time, etc.)"
          },
          {
            "name": "value",
            "type": "number",
            "required": true,
            "description": "Metric value"
          },
          {
            "name": "period",
            "type": "string",
            "required": true,
            "description": "Metric period (daily, weekly, monthly)"
          }
        ],
        "relations": [
          {
            "type": "belongsTo",
            "entity": "Team",
            "foreignKey": "teamId"
          }
        ]
      }
    ],
    "permissions": [
      {
        "resource": "Team",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "admin"
        ]
      },
      {
        "resource": "Team",
        "actions": [
          "read"
        ],
        "roles": [
          "member"
        ]
      },
      {
        "resource": "Project",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "admin"
        ]
      },
      {
        "resource": "Project",
        "actions": [
          "read"
        ],
        "roles": [
          "member"
        ]
      },
      {
        "resource": "Board",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "admin"
        ]
      },
      {
        "resource": "Board",
        "actions": [
          "read"
        ],
        "roles": [
          "member"
        ]
      },
      {
        "resource": "Task",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "admin",
          "member"
        ]
      },
      {
        "resource": "Comment",
        "actions": [
          "create",
          "read"
        ],
        "roles": [
          "admin",
          "member"
        ]
      },
      {
        "resource": "Notification",
        "actions": [
          "read",
          "update"
        ],
        "roles": [
          "admin",
          "member"
        ]
      },
      {
        "resource": "Metric",
        "actions": [
          "read"
        ],
        "roles": [
          "admin",
          "member"
        ]
      },
      {
        "resource": "User",
        "actions": [
          "read",
          "update"
        ],
        "roles": [
          "admin",
          "member"
        ]
      }
    ],
    "api": [
      {
        "path": "/api/auth/login",
        "methods": [
          "POST"
        ],
        "description": "Authenticate user and return session",
        "auth": false,
        "requestBody": {
          "email": "string",
          "password": "string"
        },
        "response": {
          "user": "User",
          "token": "string"
        }
      },
      {
        "path": "/api/auth/logout",
        "methods": [
          "POST"
        ],
        "description": "Logout user and destroy session",
        "auth": true,
        "requestBody": {},
        "response": {
          "success": "boolean"
        }
      },
      {
        "path": "/api/users/me",
        "methods": [
          "GET",
          "PATCH"
        ],
        "description": "Get or update current user profile",
        "auth": true,
        "requestBody": {
          "name": "string?",
          "avatarUrl": "string?"
        },
        "response": {
          "user": "User"
        }
      },
      {
        "path": "/api/teams",
        "methods": [
          "GET",
          "POST"
        ],
        "description": "List teams or create new team",
        "auth": true,
        "requestBody": {
          "name": "string"
        },
        "response": {
          "teams": "Team[]"
        }
      },
      {
        "path": "/api/teams/[teamId]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "description": "Get, update, or delete a team",
        "auth": true,
        "requestBody": {
          "name": "string?"
        },
        "response": {
          "team": "Team"
        }
      },
      {
        "path": "/api/projects",
        "methods": [
          "GET",
          "POST"
        ],
        "description": "List projects or create new project",
        "auth": true,
        "requestBody": {
          "name": "string",
          "description": "string?",
          "teamId": "string"
        },
        "response": {
          "projects": "Project[]"
        }
      },
      {
        "path": "/api/projects/[projectId]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "description": "Get, update, or delete a project",
        "auth": true,
        "requestBody": {
          "name": "string?",
          "description": "string?"
        },
        "response": {
          "project": "Project"
        }
      },
      {
        "path": "/api/projects/[projectId]/boards",
        "methods": [
          "GET",
          "POST"
        ],
        "description": "List or create boards for a project",
        "auth": true,
        "requestBody": {
          "name": "string"
        },
        "response": {
          "boards": "Board[]"
        }
      },
      {
        "path": "/api/boards/[boardId]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "description": "Get, update, or delete a board",
        "auth": true,
        "requestBody": {
          "name": "string?",
          "columns": "Column[]?"
        },
        "response": {
          "board": "Board"
        }
      },
      {
        "path": "/api/tasks",
        "methods": [
          "GET",
          "POST"
        ],
        "description": "List or create tasks",
        "auth": true,
        "requestBody": {
          "title": "string",
          "description": "string?",
          "assigneeId": "string?",
          "status": "string",
          "dueDate": "Date?"
        },
        "response": {
          "tasks": "Task[]"
        }
      },
      {
        "path": "/api/tasks/[taskId]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "description": "Get, update, or delete a task",
        "auth": true,
        "requestBody": {
          "title": "string?",
          "description": "string?",
          "assigneeId": "string?",
          "status": "string?",
          "dueDate": "Date?"
        },
        "response": {
          "task": "Task"
        }
      },
      {
        "path": "/api/tasks/[taskId]/comments",
        "methods": [
          "GET",
          "POST"
        ],
        "description": "List or add comments to a task",
        "auth": true,
        "requestBody": {
          "content": "string"
        },
        "response": {
          "comments": "Comment[]"
        }
      },
      {
        "path": "/api/notifications",
        "methods": [
          "GET"
        ],
        "description": "List notifications for current user",
        "auth": true,
        "requestBody": {},
        "response": {
          "notifications": "Notification[]"
        }
      },
      {
        "path": "/api/notifications/[notificationId]/read",
        "methods": [
          "POST"
        ],
        "description": "Mark notification as read",
        "auth": true,
        "requestBody": {},
        "response": {
          "notification": "Notification"
        }
      },
      {
        "path": "/api/metrics",
        "methods": [
          "GET"
        ],
        "description": "Get productivity metrics for a team",
        "auth": true,
        "requestBody": {},
        "response": {
          "metrics": "Metric[]"
        }
      }
    ],
    "pages": [
      {
        "path": "/",
        "title": "Dashboard",
        "description": "Dashboard landing page with project overview and metrics",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "AnalyticsDashboard",
          "NotificationBell",
          "UserAvatar",
          "TeamSelector"
        ]
      },
      {
        "path": "/login",
        "title": "Login",
        "description": "User login page",
        "auth": false,
        "layout": "app/layout.tsx",
        "components": []
      },
      {
        "path": "/projects",
        "title": "Projects",
        "description": "List of all projects for the current team",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "NotificationBell",
          "UserAvatar",
          "TeamSelector"
        ]
      },
      {
        "path": "/projects/[projectId]",
        "title": "Project Detail",
        "description": "Project detail page with kanban board and tasks",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "KanbanBoard",
          "TaskCard",
          "TaskModal",
          "CommentList",
          "NotificationBell",
          "UserAvatar"
        ]
      },
      {
        "path": "/projects/[projectId]/settings",
        "title": "Project Settings",
        "description": "Project settings page",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "NotificationBell",
          "UserAvatar"
        ]
      },
      {
        "path": "/teams",
        "title": "Teams",
        "description": "Team management page",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "NotificationBell",
          "UserAvatar",
          "TeamSelector"
        ]
      },
      {
        "path": "/analytics",
        "title": "Analytics",
        "description": "Productivity analytics dashboard",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "AnalyticsDashboard",
          "NotificationBell",
          "UserAvatar",
          "TeamSelector"
        ]
      },
      {
        "path": "/notifications",
        "title": "Notifications",
        "description": "User notifications center",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "NotificationBell",
          "UserAvatar"
        ]
      },
      {
        "path": "/profile",
        "title": "Profile",
        "description": "User profile and settings",
        "auth": true,
        "layout": "app/layout.tsx",
        "components": [
          "Navbar",
          "Sidebar",
          "UserAvatar",
          "NotificationBell"
        ]
      }
    ],
    "workflows": [
      {
        "name": "User Authentication",
        "steps": [
          "User navigates to /login",
          "User enters email and password",
          "POST /api/auth/login with credentials",
          "API validates credentials and returns session token",
          "User is redirected to dashboard (/)"
        ]
      },
      {
        "name": "Create Project",
        "steps": [
          "User navigates to /projects",
          "User clicks 'New Project' button",
          "User fills project form (name, description, team)",
          "POST /api/projects with project data",
          "API creates project and returns project object",
          "User is redirected to /projects/[projectId]"
        ]
      },
      {
        "name": "Create Task",
        "steps": [
          "User navigates to /projects/[projectId]",
          "User clicks 'Add Task' in a column",
          "User fills task form (title, description, assignee, due date)",
          "POST /api/tasks with task data",
          "API creates task and returns task object",
          "Task appears in the kanban board column"
        ]
      },
      {
        "name": "Move Task",
        "steps": [
          "User drags task card to different column",
          "Client updates task status locally",
          "PATCH /api/tasks/[taskId] with new status",
          "API updates task status",
          "Board reflects new task position"
        ]
      },
      {
        "name": "Add Comment",
        "steps": [
          "User clicks on task card",
          "TaskModal opens with task details",
          "User types comment in comment field",
          "POST /api/tasks/[taskId]/comments with comment content",
          "API creates comment and returns comment object",
          "Comment appears in CommentList"
        ]
      },
      {
        "name": "View Analytics",
        "steps": [
          "User navigates to /analytics",
          "GET /api/metrics with team filter",
          "API returns productivity metrics",
          "AnalyticsDashboard renders charts and metrics"
        ]
      },
      {
        "name": "Receive Notification",
        "steps": [
          "System event occurs (task assigned, comment added)",
          "API creates notification for relevant user",
          "Client polls GET /api/notifications",
          "NotificationBell updates unread count",
          "User clicks notification to view details"
        ]
      }
    ],
    "definitionOfDone": [
      "All entities (User, Team, Project, Board, Column, Task, Comment, Notification, Metric) are implemented with in-memory stores",
      "All 15 API endpoints are functional and return correct responses",
      "All 9 pages are implemented with proper routing and authentication",
      "All 10 components (Navbar, Sidebar, KanbanBoard, TaskCard, TaskModal, CommentList, AnalyticsDashboard, NotificationBell, UserAvatar, TeamSelector) are implemented with shadcn/ui and Tailwind CSS",
      "User authentication flow (login/logout) is working",
      "Team-based tenancy is enforced across all resources",
      "Role-based permissions (admin, member) are enforced on API endpoints",
      "Kanban board supports drag-and-drop task movement",
      "Task comments can be added and displayed",
      "Real-time notifications are displayed (via polling)",
      "Analytics dashboard displays productivity metrics",
      "All pages are responsive and styled with Tailwind CSS",
      "TypeScript types are defined for all entities and API responses",
      "Error handling is implemented for all API endpoints",
      "Application is deployable and runs without errors"
    ],
    "errorContract": {
      "code": "SUCCESS",
      "http": 200,
      "errors": [
        {
          "code": "UNAUTHORIZED",
          "http": 401,
          "message": "Authentication required"
        },
        {
          "code": "FORBIDDEN",
          "http": 403,
          "message": "Insufficient permissions"
        },
        {
          "code": "NOT_FOUND",
          "http": 404,
          "message": "Resource not found"
        },
        {
          "code": "VALIDATION_ERROR",
          "http": 400,
          "message": "Invalid request data"
        },
        {
          "code": "INTERNAL_ERROR",
          "http": 500,
          "message": "Internal server error"
        }
      ]
    }
  }
}