{
  "meta": {
    "buildId": "build-1768935737592",
    "repoOwner": "Anouary02",
    "repoName": "ai-app-saas",
    "branch": "build-1768935737592",
    "appName": "FitTrack Pro",
    "baseBranch": "main"
  },
  "functionalitySpec": {
    "stack": {
      "framework": "Next.js 14 App Router",
      "language": "TypeScript",
      "styling": [
        "Tailwind CSS",
        "shadcn/ui"
      ],
      "api": [
        "Next.js Route Handlers"
      ],
      "database": "In-memory store (MVP)",
      "authentication": "Session-based with password hashing"
    },
    "tenancy": {
      "strategy": "multi-tenant",
      "isolationLevel": "row-level",
      "implementation": "userId-based data isolation in shared in-memory store"
    },
    "roles": [
      {
        "name": "user",
        "permissions": [
          "read:own",
          "write:own",
          "delete:own"
        ],
        "description": "Standard authenticated user with access to their own data"
      }
    ],
    "entities": [
      {
        "name": "User",
        "description": "A registered user with authentication credentials",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique user identifier"
          },
          {
            "name": "email",
            "type": "string",
            "required": true,
            "description": "User email address"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "User's display name"
          },
          {
            "name": "passwordHash",
            "type": "string",
            "required": true,
            "description": "Hashed password"
          },
          {
            "name": "createdAt",
            "type": "Date",
            "required": true,
            "description": "Account creation timestamp"
          }
        ],
        "relations": [
          {
            "type": "one-to-many",
            "target": "WorkoutPlan",
            "field": "userId"
          },
          {
            "type": "one-to-many",
            "target": "ExerciseLog",
            "field": "userId"
          },
          {
            "type": "one-to-many",
            "target": "Goal",
            "field": "userId"
          },
          {
            "type": "one-to-many",
            "target": "NutritionLog",
            "field": "userId"
          },
          {
            "type": "one-to-many",
            "target": "Notification",
            "field": "userId"
          }
        ]
      },
      {
        "name": "WorkoutPlan",
        "description": "A personalized workout plan for a user",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique plan identifier"
          },
          {
            "name": "userId",
            "type": "string",
            "required": true,
            "description": "Owner user ID"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Plan name"
          },
          {
            "name": "description",
            "type": "string",
            "required": false,
            "description": "Plan description"
          },
          {
            "name": "createdAt",
            "type": "Date",
            "required": true,
            "description": "Creation timestamp"
          },
          {
            "name": "exercises",
            "type": "ExerciseTemplate[]",
            "required": true,
            "description": "List of exercises in the plan"
          }
        ],
        "relations": [
          {
            "type": "many-to-one",
            "target": "User",
            "field": "userId"
          },
          {
            "type": "one-to-many",
            "target": "ExerciseTemplate",
            "field": "workoutPlanId"
          }
        ]
      },
      {
        "name": "ExerciseTemplate",
        "description": "Template for an exercise within a workout plan",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique exercise template ID"
          },
          {
            "name": "name",
            "type": "string",
            "required": true,
            "description": "Exercise name"
          },
          {
            "name": "targetMuscle",
            "type": "string",
            "required": false,
            "description": "Targeted muscle group"
          },
          {
            "name": "sets",
            "type": "number",
            "required": true,
            "description": "Number of sets"
          },
          {
            "name": "reps",
            "type": "number",
            "required": true,
            "description": "Number of reps per set"
          }
        ],
        "relations": [
          {
            "type": "many-to-one",
            "target": "WorkoutPlan",
            "field": "workoutPlanId"
          }
        ]
      },
      {
        "name": "ExerciseLog",
        "description": "A user's log entry for a performed exercise",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique log entry ID"
          },
          {
            "name": "userId",
            "type": "string",
            "required": true,
            "description": "User who performed the exercise"
          },
          {
            "name": "workoutPlanId",
            "type": "string",
            "required": false,
            "description": "Associated workout plan"
          },
          {
            "name": "exerciseName",
            "type": "string",
            "required": true,
            "description": "Name of the exercise"
          },
          {
            "name": "date",
            "type": "Date",
            "required": true,
            "description": "Date of exercise"
          },
          {
            "name": "sets",
            "type": "number",
            "required": true,
            "description": "Sets performed"
          },
          {
            "name": "reps",
            "type": "number",
            "required": true,
            "description": "Reps per set"
          },
          {
            "name": "weight",
            "type": "number",
            "required": false,
            "description": "Weight used (kg)"
          },
          {
            "name": "notes",
            "type": "string",
            "required": false,
            "description": "Optional notes"
          }
        ],
        "relations": [
          {
            "type": "many-to-one",
            "target": "User",
            "field": "userId"
          },
          {
            "type": "many-to-one",
            "target": "WorkoutPlan",
            "field": "workoutPlanId"
          }
        ]
      },
      {
        "name": "Goal",
        "description": "A fitness goal set by the user",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique goal ID"
          },
          {
            "name": "userId",
            "type": "string",
            "required": true,
            "description": "Owner user ID"
          },
          {
            "name": "type",
            "type": "string",
            "required": true,
            "description": "Goal type (e.g. weight, reps, frequency)"
          },
          {
            "name": "targetValue",
            "type": "number",
            "required": true,
            "description": "Target value for the goal"
          },
          {
            "name": "currentValue",
            "type": "number",
            "required": false,
            "description": "Current progress value"
          },
          {
            "name": "unit",
            "type": "string",
            "required": false,
            "description": "Unit of measurement"
          },
          {
            "name": "deadline",
            "type": "Date",
            "required": false,
            "description": "Goal deadline"
          }
        ],
        "relations": [
          {
            "type": "many-to-one",
            "target": "User",
            "field": "userId"
          }
        ]
      },
      {
        "name": "NutritionLog",
        "description": "A user's nutrition log entry",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique nutrition log ID"
          },
          {
            "name": "userId",
            "type": "string",
            "required": true,
            "description": "Owner user ID"
          },
          {
            "name": "date",
            "type": "Date",
            "required": true,
            "description": "Date of entry"
          },
          {
            "name": "mealType",
            "type": "string",
            "required": true,
            "description": "Meal type (breakfast, lunch, etc.)"
          },
          {
            "name": "calories",
            "type": "number",
            "required": false,
            "description": "Calories consumed"
          },
          {
            "name": "protein",
            "type": "number",
            "required": false,
            "description": "Protein (g)"
          },
          {
            "name": "carbs",
            "type": "number",
            "required": false,
            "description": "Carbohydrates (g)"
          },
          {
            "name": "fat",
            "type": "number",
            "required": false,
            "description": "Fat (g)"
          },
          {
            "name": "notes",
            "type": "string",
            "required": false,
            "description": "Optional notes"
          }
        ],
        "relations": [
          {
            "type": "many-to-one",
            "target": "User",
            "field": "userId"
          }
        ]
      },
      {
        "name": "Notification",
        "description": "A scheduled or triggered notification",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "description": "Unique notification ID"
          },
          {
            "name": "userId",
            "type": "string",
            "required": true,
            "description": "Recipient user ID"
          },
          {
            "name": "type",
            "type": "string",
            "required": true,
            "description": "Notification type (reminder, goal, etc.)"
          },
          {
            "name": "message",
            "type": "string",
            "required": true,
            "description": "Notification message"
          },
          {
            "name": "scheduledAt",
            "type": "Date",
            "required": false,
            "description": "Scheduled time"
          },
          {
            "name": "read",
            "type": "boolean",
            "required": true,
            "description": "Has the notification been read"
          }
        ],
        "relations": [
          {
            "type": "many-to-one",
            "target": "User",
            "field": "userId"
          }
        ]
      }
    ],
    "permissions": [
      {
        "resource": "User",
        "actions": [
          "read",
          "update"
        ],
        "roles": [
          "user"
        ],
        "scope": "own"
      },
      {
        "resource": "WorkoutPlan",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "user"
        ],
        "scope": "own"
      },
      {
        "resource": "ExerciseLog",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "user"
        ],
        "scope": "own"
      },
      {
        "resource": "Goal",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "user"
        ],
        "scope": "own"
      },
      {
        "resource": "NutritionLog",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "user"
        ],
        "scope": "own"
      },
      {
        "resource": "Notification",
        "actions": [
          "create",
          "read",
          "update",
          "delete"
        ],
        "roles": [
          "user"
        ],
        "scope": "own"
      }
    ],
    "api": [
      {
        "path": "/api/auth/login",
        "methods": [
          "POST"
        ],
        "auth": false,
        "description": "Authenticate user and return session token",
        "request": {
          "email": "string",
          "password": "string"
        },
        "response": {
          "token": "string",
          "user": "User"
        }
      },
      {
        "path": "/api/auth/register",
        "methods": [
          "POST"
        ],
        "auth": false,
        "description": "Register a new user",
        "request": {
          "email": "string",
          "password": "string",
          "name": "string"
        },
        "response": {
          "token": "string",
          "user": "User"
        }
      },
      {
        "path": "/api/auth/logout",
        "methods": [
          "POST"
        ],
        "auth": true,
        "description": "Logout user and destroy session",
        "request": {},
        "response": {
          "success": "boolean"
        }
      },
      {
        "path": "/api/user",
        "methods": [
          "GET",
          "PATCH"
        ],
        "auth": true,
        "description": "Get or update current user profile",
        "request": {
          "name": "string"
        },
        "response": {
          "user": "User"
        }
      },
      {
        "path": "/api/workouts",
        "methods": [
          "GET",
          "POST"
        ],
        "auth": true,
        "description": "List all workout plans for user or create new plan",
        "request": {
          "name": "string",
          "description": "string",
          "exercises": "ExerciseTemplate[]"
        },
        "response": {
          "workoutPlans": "WorkoutPlan[]"
        }
      },
      {
        "path": "/api/workouts/[id]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "auth": true,
        "description": "Get, update, or delete a specific workout plan",
        "request": {
          "name": "string",
          "description": "string",
          "exercises": "ExerciseTemplate[]"
        },
        "response": {
          "workoutPlan": "WorkoutPlan"
        }
      },
      {
        "path": "/api/exerciselogs",
        "methods": [
          "GET",
          "POST"
        ],
        "auth": true,
        "description": "List or create exercise log entries",
        "request": {
          "workoutPlanId": "string",
          "exerciseName": "string",
          "date": "Date",
          "sets": "number",
          "reps": "number",
          "weight": "number",
          "notes": "string"
        },
        "response": {
          "exerciseLogs": "ExerciseLog[]"
        }
      },
      {
        "path": "/api/exerciselogs/[id]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "auth": true,
        "description": "Get, update, or delete a specific exercise log entry",
        "request": {
          "exerciseName": "string",
          "sets": "number",
          "reps": "number",
          "weight": "number",
          "notes": "string"
        },
        "response": {
          "exerciseLog": "ExerciseLog"
        }
      },
      {
        "path": "/api/goals",
        "methods": [
          "GET",
          "POST"
        ],
        "auth": true,
        "description": "List or create user goals",
        "request": {
          "type": "string",
          "targetValue": "number",
          "currentValue": "number",
          "unit": "string",
          "deadline": "Date"
        },
        "response": {
          "goals": "Goal[]"
        }
      },
      {
        "path": "/api/goals/[id]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "auth": true,
        "description": "Get, update, or delete a specific goal",
        "request": {
          "type": "string",
          "targetValue": "number",
          "currentValue": "number",
          "unit": "string",
          "deadline": "Date"
        },
        "response": {
          "goal": "Goal"
        }
      },
      {
        "path": "/api/nutritionlogs",
        "methods": [
          "GET",
          "POST"
        ],
        "auth": true,
        "description": "List or create nutrition log entries",
        "request": {
          "date": "Date",
          "mealType": "string",
          "calories": "number",
          "protein": "number",
          "carbs": "number",
          "fat": "number",
          "notes": "string"
        },
        "response": {
          "nutritionLogs": "NutritionLog[]"
        }
      },
      {
        "path": "/api/nutritionlogs/[id]",
        "methods": [
          "GET",
          "PATCH",
          "DELETE"
        ],
        "auth": true,
        "description": "Get, update, or delete a specific nutrition log entry",
        "request": {
          "mealType": "string",
          "calories": "number",
          "protein": "number",
          "carbs": "number",
          "fat": "number",
          "notes": "string"
        },
        "response": {
          "nutritionLog": "NutritionLog"
        }
      },
      {
        "path": "/api/notifications",
        "methods": [
          "GET",
          "POST"
        ],
        "auth": true,
        "description": "List or create notifications",
        "request": {
          "type": "string",
          "message": "string",
          "scheduledAt": "Date"
        },
        "response": {
          "notifications": "Notification[]"
        }
      },
      {
        "path": "/api/notifications/[id]",
        "methods": [
          "PATCH",
          "DELETE"
        ],
        "auth": true,
        "description": "Update or delete a notification",
        "request": {
          "read": "boolean"
        },
        "response": {
          "notification": "Notification"
        }
      }
    ],
    "pages": [
      {
        "path": "/",
        "title": "Dashboard",
        "auth": true,
        "description": "Landing/dashboard page after login with overview of workouts, goals, and recent activity",
        "components": [
          "Navbar",
          "ProgressDashboard",
          "GoalList"
        ]
      },
      {
        "path": "/login",
        "title": "Login",
        "auth": false,
        "description": "User login page with email and password authentication",
        "components": [
          "AuthForm"
        ]
      },
      {
        "path": "/register",
        "title": "Register",
        "auth": false,
        "description": "User registration page with email, password, and name fields",
        "components": [
          "AuthForm"
        ]
      },
      {
        "path": "/workouts",
        "title": "Workout Plans",
        "auth": true,
        "description": "List and manage workout plans with create, edit, and delete actions",
        "components": [
          "Navbar",
          "WorkoutPlanList",
          "WorkoutPlanForm"
        ]
      },
      {
        "path": "/workouts/[id]",
        "title": "Edit Workout Plan",
        "auth": true,
        "description": "View and edit a specific workout plan with exercise templates",
        "components": [
          "Navbar",
          "WorkoutPlanForm"
        ]
      },
      {
        "path": "/log",
        "title": "Log Exercise",
        "auth": true,
        "description": "Log a new exercise session with sets, reps, weight, and notes",
        "components": [
          "Navbar",
          "ExerciseLogForm"
        ]
      },
      {
        "path": "/progress",
        "title": "Progress",
        "auth": true,
        "description": "Progress dashboard with analytics, charts, and goal tracking",
        "components": [
          "Navbar",
          "ProgressDashboard",
          "ExerciseLogList",
          "GoalList"
        ]
      },
      {
        "path": "/goals",
        "title": "Goals",
        "auth": true,
        "description": "Set and manage fitness goals with progress tracking",
        "components": [
          "Navbar",
          "GoalList",
          "GoalForm"
        ]
      },
      {
        "path": "/nutrition",
        "title": "Nutrition",
        "auth": true,
        "description": "Log and view nutrition entries with macros and meal types",
        "components": [
          "Navbar",
          "NutritionLogForm",
          "NutritionLogList"
        ]
      },
      {
        "path": "/notifications",
        "title": "Notifications",
        "auth": true,
        "description": "View and manage notifications and reminders",
        "components": [
          "Navbar",
          "NotificationList"
        ]
      },
      {
        "path": "/settings",
        "title": "Settings",
        "auth": true,
        "description": "User profile and settings management",
        "components": [
          "Navbar",
          "UserSettingsForm"
        ]
      }
    ],
    "workflows": [
      {
        "name": "User Registration and Onboarding",
        "steps": [
          "User navigates to /register",
          "User fills in email, name, and password",
          "System validates input and creates user account",
          "System hashes password and stores user",
          "System creates session token",
          "User is redirected to dashboard"
        ]
      },
      {
        "name": "Create Workout Plan",
        "steps": [
          "User navigates to /workouts",
          "User clicks create new plan",
          "User fills in plan name, description, and exercises",
          "System validates and saves workout plan",
          "User is redirected to workout plan list"
        ]
      },
      {
        "name": "Log Exercise Session",
        "steps": [
          "User navigates to /log",
          "User selects or enters exercise name",
          "User enters sets, reps, weight, and optional notes",
          "System saves exercise log with current date",
          "User sees confirmation and can log another exercise"
        ]
      },
      {
        "name": "Track Goal Progress",
        "steps": [
          "User navigates to /goals",
          "User creates a new goal with type, target, and deadline",
          "System saves goal and initializes current value",
          "User logs exercises or updates progress",
          "System updates goal current value based on logs",
          "User views progress on /progress dashboard"
        ]
      },
      {
        "name": "Log Nutrition",
        "steps": [
          "User navigates to /nutrition",
          "User selects meal type and date",
          "User enters calories, protein, carbs, fat, and notes",
          "System saves nutrition log",
          "User views nutrition history and daily totals"
        ]
      }
    ],
    "definitionOfDone": [
      "All 7 entities (User, WorkoutPlan, ExerciseTemplate, ExerciseLog, Goal, NutritionLog, Notification) are implemented with in-memory store",
      "All 14 API routes are functional with proper authentication and authorization",
      "All 11 pages are implemented with Next.js App Router and proper layouts",
      "Authentication flow (login, register, logout) works end-to-end",
      "Users can create, read, update, and delete workout plans",
      "Users can log exercises with sets, reps, and weight",
      "Users can set and track fitness goals",
      "Users can log nutrition with macros",
      "Users can view and manage notifications",
      "Progress dashboard displays analytics and charts",
      "All UI components use shadcn/ui and Tailwind CSS",
      "Data isolation ensures users only access their own data",
      "All forms have proper validation and error handling",
      "Session-based authentication is secure with password hashing",
      "Application is responsive and works on mobile devices"
    ],
    "errorContract": {
      "code": "FITTRACK_ERROR",
      "http": 200,
      "structure": {
        "success": false,
        "error": {
          "code": "string",
          "message": "string",
          "details": "object"
        }
      },
      "errorCodes": [
        "AUTH_INVALID_CREDENTIALS",
        "AUTH_USER_EXISTS",
        "AUTH_UNAUTHORIZED",
        "VALIDATION_FAILED",
        "RESOURCE_NOT_FOUND",
        "RESOURCE_FORBIDDEN",
        "INTERNAL_ERROR"
      ]
    }
  }
}